
SET(FREESPACE_SRC freespace.cpp
				levelpaging.cpp
				freespace.h
				levelpaging.h
				freespace.rc)

ADD_EXECUTABLE(Freespace2 WIN32 ${FREESPACE_SRC})

SET_TARGET_PROPERTIES(Freespace2 PROPERTIES DEBUG_POSTFIX "-DEBUG")

set_target_properties(Freespace2 PROPERTIES
	COMPILE_DEFINITIONS_RELEASE "NDEBUG"
	COMPILE_DEFINITIONS_DEBUG "_DEBUG"
)

IF(MSVC)
	set_target_properties(Freespace2 PROPERTIES
		COMPILE_DEFINITIONS_DEBUG "_DEBUG;PDB_DEBUGGING=1;_HAS_ITERATOR_DEBUGGING=0"
	)
ENDIF(MSVC)

IF (FSO_INSTRUCTION_SET STREQUAL "")
	SET_TARGET_PROPERTIES(Freespace2 PROPERTIES OUTPUT_NAME "fs2_open_${FSO_VERSION_MAJOR}_${FSO_VERSION_MINOR}_${FSO_VERSION_RELEASE}")
ELSE(FSO_INSTRUCTION_SET STREQUAL "")
	SET_TARGET_PROPERTIES(Freespace2 PROPERTIES OUTPUT_NAME "fs2_open_${FSO_VERSION_MAJOR}_${FSO_VERSION_MINOR}_${FSO_VERSION_RELEASE}_${FSO_INSTRUCTION_SET}")
ENDIF(FSO_INSTRUCTION_SET STREQUAL "")


set_source_files_properties(fred.rc PROPERTIES LANGUAGE RC)
SET_SOURCE_FILES_PROPERTIES(freespace.rc PROPERTIES COMPILE_DEFINITIONS "_VC08")

IF(NOT FSO_INSTRUCTION_SET STREQUAL "")
	SET_SOURCE_FILES_PROPERTIES(freespace.rc PROPERTIES COMPILE_DEFINITIONS "_VC08;_${FSO_INSTRUCTION_SET}")
ENDIF(NOT FSO_INSTRUCTION_SET STREQUAL "")

TARGET_LINK_LIBRARIES(Freespace2 code)
TARGET_LINK_LIBRARIES(Freespace2 ${JPEG_LIBRARIES})
TARGET_LINK_LIBRARIES(Freespace2 ${PNG_LIBRARIES})
TARGET_LINK_LIBRARIES(Freespace2 ${LUA_LIBRARIES})
TARGET_LINK_LIBRARIES(Freespace2 ${OGGVORBIS_LIBRARIES})
TARGET_LINK_LIBRARIES(Freespace2 ${THEORA_LIBRARIES})
TARGET_LINK_LIBRARIES(Freespace2 ${OPENAL_LIBRARY})
TARGET_LINK_LIBRARIES(Freespace2 ${PLATFORM_LBRARIES})
TARGET_LINK_LIBRARIES(Freespace2 ${COMPILER_LBRARIES})

IF (FSO_USE_SPEECH)
	TARGET_LINK_LIBRARIES(Freespace2 ${SPEECH_LIBRARIES})
	INCLUDE_DIRECTORIES(${SPEECH_INCLUDE_DIRS})
	ADD_DEFINITIONS(-DFS2_SPEECH)
ENDIF(FSO_USE_SPEECH)

IF(FSO_USE_VOICEREC)
	ADD_DEFINITIONS(-DFS2_VOICER)
ENDIF(FSO_USE_VOICEREC)

INCLUDE_DIRECTORIES(${COMPILER_INCLUDES})
INCLUDE_DIRECTORIES(${PLATFORM_INCLUDES})
INCLUDE_DIRECTORIES(${OPENAL_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${VORBIS_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${OGG_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${LUA_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${PNG_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${JPEG_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${CODE_HEADERS})
INCLUDE_DIRECTORIES(${FREESPACE_HEADERS})
INCLUDE_DIRECTORIES(${THEORA_INCLUDE_DIRS})

# Add install script to copy the executable to the FreeSpace path if possible and wanted
IF(FSO_COPY_EXE)
	IF(IS_DIRECTORY ${FSO_FS2_PATH})
		INSTALL(
			TARGETS Freespace2
			RUNTIME
			DESTINATION ${FSO_FS2_PATH}
			CONFIGURATIONS Debug Release
			)			
	ELSE(IS_DIRECTORY ${FSO_FS2_PATH})
		MESSAGE(STATUS "The path '${FSO_FS2_PATH}' of the variable FSO_FS2_PATH does not point to a directory!")
	ENDIF(IS_DIRECTORY ${FSO_FS2_PATH})
ENDIF(FSO_COPY_EXE)
